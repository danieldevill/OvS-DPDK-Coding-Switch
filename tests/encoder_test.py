import scapy.all as scapy
import sys

#Send 10 VLAN paclkets. With data = "Test"

eth_src = "42:43:5d:3f:df:44" 
eth_dst = "02:01:02:03:04:08" 
eth_type = 0x8000 

p0 = "\xfb\x99\xc6\x4d\x0f\x47\xff\x0a\x8a\xd5\x21\x25\xd4\x68\xc8\x6a\xe4\xa0\x85\x53\x98\xa1\xe9\x5d\x7f\xb0\xac\x22\x62\x97\x5f\xe5\xbf\x1a\x44\x10\x64\xdd\x41\xea\x05\x3e\x24\x63\x1f\xeb\x99\x7b\x18\x37\x19\x74\xff\xec\x00\x18\x89\x4d\x52\xcd\xc7\x71\x99\x83"
p1 = "\x6d\x17\x6e\xd4\x70\xbb\x70\x37\x4a\x46\xa1\x57\x0b\xb4\x86\x27\xb2\x13\x94\x09\x22\xf9\x90\xbb\x29\x58\x6c\xdb\xb9\x8b\xea\x72\x4e\x19\x7b\x11\xbf\x2c\x50\x30\x5f\xff\x71\x5a\xad\x79\x27\x22\xf5\x96\x06\xa1\x40\x1c\x42\xd2\xd4\x12\xee\x5d\x84\xda\x8e\x72"
p2 = "\x49\x3e\xd5\x8d\x00\x3e\x64\x0b\x95\xb4\xd2\x70\x90\xce\xb0\x75\x37\x07\x9c\x0d\xac\x09\x54\x68\x2f\x3a\x2b\xa9\x77\xd7\xab\xce\xff\xab\x7d\x4d\x28\x13\x12\x85\xf7\x8d\xbf\xf5\xa0\x5e\x42\xd9\x85\xb9\x95\x4d\x92\x66\xaf\xde\x9f\x45\xd8\x30\x6c\x22\x40\xfd"
p3 = "\x24\xaa\xf4\x5f\xb1\xe6\x1c\x31\xb4\x8e\x6c\x88\x5a\x2f\x07\xa4\x73\x53\xed\x77\x53\xb5\xb4\x86\xf8\xa3\xcd\xcf\xd0\x92\x98\x7e\xdf\x39\xb9\x47\x73\xa1\xa1\x1f\x28\x2c\xef\x48\x6b\x47\x7e\x07\x19\xa5\x4d\x5c\x1d\x55\x80\xc9\x64\x5a\xa9\x92\xc3\x38\xcd\x5f"
p4 = "\xce\x31\x3c\x2d\xf4\x3b\xe0\x6d\xdb\x63\xd7\xd3\xfa\x91\x87\xe8\xfa\xe2\xe8\x04\x7e\x6b\x2a\xeb\x72\xca\xdb\xc5\xc4\x71\x49\xb2\x16\x18\xe7\x9f\xc8\x4b\xb4\xab\x35\x68\xa0\x5b\x68\xd3\xae\x13\x6e\xfa\x2a\x59\x92\xfa\x42\x40\x5f\x3d\xca\xca\xe0\xf2\x8d\x4d"
p5 = "\xf2\x21\xf1\xf8\x41\xac\x9f\x73\x0d\x79\xca\xe8\xa5\x38\xc7\x8b\xf7\xf6\xe9\x42\xc3\x77\x43\x09\x3e\xfa\xbe\xec\x1b\x3f\xee\xb1\x03\x65\x13\x58\x0e\x05\xc7\x66\xf8\x97\xaa\x6c\x85\x04\xff\x55\xcb\x41\x35\x68\xdf\x9f\x83\xe6\xc8\xa7\x79\xc3\xd1\xc5\xce\xd9"
p6 = "\x01\x7c\x6c\x3d\xb3\x91\xd0\xed\xba\x60\xc3\x66\xd9\xca\x9b\x20\x0f\x3e\x5e\xef\x10\xae\x52\x1b\xf9\xd4\x4b\x31\x1d\x8b\x06\xd5\x32\xe1\xce\x02\x60\x12\x31\x22\x0c\x35\xda\x75\xa6\x31\x72\x83\x52\xdd\x2d\xec\x44\x66\x8f\xc7\x6a\x88\x7d\x7f\x1f\xc3\xc1\x1e"

l2packet0 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p0)
l2packet1 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p1)
l2packet2 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p2)
l2packet3 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p3)
l2packet4 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p4)
l2packet5 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p5)
l2packet6 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p6)

s = scapy.conf.L2socket(iface="br0")

s.send(l2packet0)
s.send(l2packet1)
s.send(l2packet2)
s.send(l2packet3)
s.send(l2packet4)
s.send(l2packet5)
s.send(l2packet6)
