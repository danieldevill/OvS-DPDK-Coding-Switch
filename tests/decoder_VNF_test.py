import scapy.all as scapy
import sys

eth_src = "42:43:5d:3f:df:44" 
eth_dst = "02:01:02:03:04:08" 
eth_type = 0x2020 

#Encoded packet data
e0 = "\x7b\xae\x15\xc9\x39\x4c\x1a\xfd\x07\x4d\x25\x87\x54\xbf\xdb\xcb\xcd\x56\x6c\x29\xe3\xfb\xf5\x76\x09\x7c\xc6\x98\xea\xd2\xbc\x90\x74\xc9\x50\x07\x75\x2d\x1e\x98\x8c\x05\x87\xee\xf9\xe4\x41\xb0\x21\x4d\x08\x44\xb7\x5d\xda\x76\x97\x1c\x49\xb5\xe3\xf9\xeb\xbe"
e1 = "\xcf\x3a\xcc\xe8\x53\xd3\xb7\x5e\x67\xaf\x1b\x15\xc2\x65\xb7\xe8\x8e\x67\xf5\x27\xcf\xde\xee\x79\xa1\x6c\x50\x15\xc9\xb5\x64\xb1\xa1\x68\xb1\xbb\x6f\x2b\xa4\x92\x95\xa1\x6d\x2a\x8e\xda\xfe\xdc\xad\x63\x4d\xac\x9c\x78\xb7\x89\xe2\xe2\xd9\xde\x8b\x6c\x73\x36"
e2 = "\x9b\x4e\x5c\x70\x24\xda\x68\x2f\xb7\xf3\x9f\x9b\x78\x48\x8c\x84\xde\xcc\x42\x03\xc3\xd5\x23\x95\xf3\xd7\xc2\xd8\x13\x55\x24\xc6\x3d\xeb\x09\xc3\xe6\x48\x13\x39\x2d\xa8\xb4\x70\x12\xd4\x73\x53\x27\x1b\xb0\x3e\x3d\xe2\xf7\x34\xb8\xc4\xea\xdf\xab\xc4\x39\xb1"
e3 = "\x20\xfc\x07\x62\xd4\x14\x60\x4b\x93\xce\x0d\x05\x7f\x2d\x4b\xbc\x67\x74\xd2\x81\xa9\x63\xea\x52\xb1\xa9\x98\xa2\xfd\x25\x14\x7c\xa6\xd5\x73\x64\xee\xc1\x8b\x3d\xf3\xb5\x2c\x6f\x89\x8b\x0f\x65\xfd\x71\xf7\xca\x49\x12\x3f\xe5\x63\x2d\x3a\x62\xa9\x8c\xdb\x35"
e4 = "\x06\x8d\x44\xc8\x1f\x3f\xae\x25\x43\x04\x1c\x9a\xcd\x65\x98\xf9\xf9\xec\x15\x22\xe5\x60\x28\x26\x5c\xf0\xe9\xb1\x4f\x79\x91\x46\x94\x33\x48\x7f\x98\xd8\xe2\x91\x70\x4f\x4d\x21\x34\x50\x57\xfb\xdf\xc3\x14\xe5\x52\x10\xa4\xa7\x93\x6b\x67\xf9\xab\x7f\x30\x13"
e5 = "\xdf\x85\xe8\xbc\xda\xa9\x6e\x69\xfd\xdc\xdd\x82\xbb\xe1\xc0\x4e\xc1\x35\x3a\xc6\x3e\xac\xfe\xe3\xdb\xfb\xfb\x3d\xd4\x74\xa6\xf0\x0e\x67\x51\x9e\x9f\xb8\x0d\xf4\x57\x23\x2e\x02\xb6\xcc\xe9\xcc\x0a\xe7\x0b\x28\x1b\x14\xb4\x38\xc1\x92\x84\xc9\x0e\x84\x4d\x84"
e6 = "\x37\x29\x2f\xf4\x92\xf8\xc2\x0e\xbe\xb4\x99\x88\xf5\x21\xb3\x36\xed\x50\x43\xd6\x50\xa1\xce\x84\xf5\x31\x26\x94\x8f\xdc\x5a\xc5\x22\x4a\x4d\x84\x38\x11\xe2\x9d\x0c\x09\xf5\x85\x47\xa4\x18\x67\x3f\xeb\x72\x84\xc8\x89\x06\x3a\x85\x7a\x10\xcb\x40\x7d\xa9\x05"

#Coefficient data
c0 = "\x9d\xb5\xd6\xfc\x99\x31\xcf"
c1 = "\x13\x6d\xb9\x15\xff\x54\x69"
c2 = "\x14\xaa\x13\x45\x07\x53\x83"
c3 = "\xd5\x2f\xcf\x8b\xe2\x0e\x6b"
c4 = "\xf4\x5f\xf7\x24\x74\x9a\x21"
c5 = "\x5c\xb7\xeb\x73\x0b\x47\xf1"
c6 = "\xc9\xe0\x9b\xd9\x29\x71\x97"

#GENID
g0 = "\xaa\xbb\xcc\xdd\xee\x11\x22\x33\x00"

#Packet ex + cx for x in 0-6:
p0 = g0 + c0 + e0
p1 = g0 + c1 + e1
p2 = g0 + c2 + e2
p3 = g0 + c3 + e3
p4 = g0 + c4 + e4
p5 = g0 + c5 + e5
p6 = g0 + c6 + e6


l2packet0 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p0)
l2packet1 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p1)
l2packet2 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p2)
l2packet3 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p3)
l2packet4 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p4)
l2packet5 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p5)
l2packet6 = scapy.Ether(type=eth_type,src=eth_src,dst=eth_dst)/scapy.Raw(load=p6)

for i in range(0,1000000):
  scapy.sendp(l2packet0,count=1,iface="br0")
  scapy.sendp(l2packet1,count=1,iface="br0")
  scapy.sendp(l2packet2,count=1,iface="br0")
  scapy.sendp(l2packet3,count=1,iface="br0")
  scapy.sendp(l2packet4,count=1,iface="br0")
  scapy.sendp(l2packet5,count=1,iface="br0")
  scapy.sendp(l2packet6,count=1,iface="br0")